<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>مصحف الجوال التفاعلي</title>
    <style>
        :root { --gold: #b08d57; --paper: #fdfdfd; --text: #2c3e50; }
        body { background: #f0f0f0; margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; font-family: 'Segoe UI', sans-serif; }

        /* الهيدر الأنيق */
        .header { background: white; padding: 10px 15px; border-bottom: 2px solid var(--gold); display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.05); z-index: 100; }
        .title-group { display: flex; flex-direction: column; }
        #sName { color: var(--gold); font-weight: bold; font-size: 16px; }
        .page-info { font-size: 11px; color: #7f8c8d; }

        /* منطقة القراءة التفاعلية */
        .main-container { flex: 1; position: relative; background: #eee; overflow: hidden; display: flex; justify-content: center; align-items: center; }
        
        .page-wrapper {
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94); /* حركة انزلاق ناعمة */
        }

        #qPage {
            max-width: 95%;
            max-height: 95%;
            object-fit: contain;
            background: white;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            border-radius: 4px;
            transition: opacity 0.3s;
        }

        /* شريط التحكم السفلي */
        .bottom-bar { background: white; padding: 8px; display: flex; gap: 8px; border-top: 1px solid #eee; justify-content: center; }
        .input-style { border: 1px solid #ddd; border-radius: 20px; padding: 5px 12px; font-size: 12px; outline: none; }
        .btn-round { background: var(--gold); border: none; color: white; padding: 8px 20px; border-radius: 20px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .btn-round:active { transform: scale(0.9); opacity: 0.8; }
    </style>
</head>
<body>

<div class="header">
    <div class="title-group">
        <span id="sName">سورة الفاتحة</span>
        <span class="page-info">صفحة رقم <span id="pNum">1</span></span>
    </div>
    <div class="controls">
        <select id="sList" class="input-style" style="width: 100px;" onchange="jumpTo(this.value)"></select>
    </div>
</div>

<div class="main-container" id="touchArea">
    <div class="page-wrapper" id="pageWrapper">
        <img id="qPage" src="001.jpg" onerror="this.src='https://raw.githubusercontent.com/search5/quran-images/master/001.jpg'">
    </div>
</div>

<div class="bottom-bar">
    <input type="text" class="input-style" placeholder="ابحث عن سورة.." oninput="filterSurahs(this.value)">
    <button class="btn-round" onclick="goPrev()">السابق</button>
    <button class="btn-round" onclick="goNext()">التالي</button>
</div>

<script>
    let p = parseInt(localStorage.getItem('lastPage')) || 1; // مهارة: حفظ آخر صفحة
    let xStart = null;
    let isMoving = false;

    const data = [
        {n:"الفاتحة",p:1},{n:"البقرة",p:2},{n:"آل عمران",p:50},{n:"النساء",p:77},{n:"المائدة",p:106},{n:"الأنعام",p:128},{n:"الأعراف",p:151},{n:"الأنفال",p:177},{n:"التوبة",p:187},{n:"يونس",p:208},{n:"هود",p:221},{n:"يوسف",p:235},{n:"الرعد",p:249},{n:"إبراهيم",p:255},{n:"الحجر",p:262},{n:"النحل",p:267},{n:"الإسراء",p:282},{n:"الكهف",p:293},{n:"مريم",p:305},{n:"طه",p:312},{n:"الأنبياء",p:322},{n:"الحج",p:332},{n:"المؤمنون",p:342},{n:"النور",p:350},{n:"الفرقان",p:359},{n:"الشعراء",p:367},{n:"النمل",p:377},{n:"القصص",p:385},{n:"العنكبوت",p:396},{n:"الروم",p:404},{n:"لقمان",p:411},{n:"السجدة",p:415},{n:"الأحزاب",p:418},{n:"سبأ",p:428},{n:"فاطر",p:434},{n:"يس",p:440},{n:"الصافات",p:446},{n:"ص",p:453},{n:"الزمر",p:458},{n:"غافر",p:467},{n:"فصلت",p:477},{n:"الشورى",p:483},{n:"الزخرف",p:489},{n:"الدخان",p:496},{n:"الجاثية",p:499},{n:"الأحقاف",p:502},{n:"محمد",p:507},{n:"الفتح",p:511},{n:"الحجرات",p:515},{n:"ق",p:518},{n:"الذاريات",p:520},{n:"الطور",p:523},{n:"النجم",p:526},{n:"القمر",p:528},{n:"الرحمن",p:531},{n:"الواقعة",p:534},{n:"الحديد",p:537},{n:"المجادلة",p:542},{n:"الحشر",p:545},{n:"الممتحنة",p:549},{n:"الصف",p:551},{n:"الجمعة",p:553},{n:"المنافقون",p:554},{n:"التغابن",p:556},{n:"الطلاق",p:558},{n:"التحريم",p:560},{n:"الملك",p:562},{n:"القلم",p:564},{n:"الحاقة",p:566},{n:"المعارج",p:568},{n:"نوح",p:570},{n:"الجن",p:572},{n:"المزمل",p:574},{n:"المدثر",p:575},{n:"القيامة",p:577},{n:"الإنسان",p:578},{n:"المرسلات",p:580},{n:"النبأ",p:582},{n:"النازعات",p:583},{n:"عبس",p:585},{n:"التكوير",p:586},{n:"الانفطار",p:587},{n:"المطففين",p:587},{n:"الانشقاق",p:589},{n:"البروج",p:590},{n:"الطارق",p:591},{n:"الأعلى",p:591},{n:"الغاشية",p:592},{n:"الفجر",p:593},{n:"البلد",p:594},{n:"الشمس",p:595},{n:"الليل",p:595},{n:"الضحى",p:596},{n:"الشرح",p:596},{n:"التين",p:597},{n:"العلق",p:597},{n:"القدر",p:598},{n:"البينة",p:598},{n:"الزلزلة",p:599},{n:"العاديات",p:599},{n:"القارعة",p:600},{n:"التكاثر",p:600},{n:"العصر",p:601},{n:"الهمزة",p:601},{n:"الفيل",p:601},{n:"قريش",p:602},{n:"الماعون",p:602},{n:"الكوثر",p:602},{n:"الكافرون",p:603},{n:"النصر",p:603},{n:"المسد",p:603},{n:"الإخلاص",p:604},{n:"الفلق",p:604},{n:"الناس",p:604}
    ];

    function draw(direction) {
        const img = document.getElementById('qPage');
        const wrapper = document.getElementById('pageWrapper');
        
        // مهارة: أنيميشن الانزلاق
        wrapper.style.transform = direction === 'next' ? 'translateX(100%)' : 'translateX(-100%)';
        wrapper.style.opacity = '0';

        setTimeout(() => {
            const num = p.toString().padStart(3, '0');
            img.src = `${num}.jpg`;
            document.getElementById('pNum').innerText = p;
            
            const s = data.filter(x => x.p <= p).slice(-1)[0];
            if(s) document.getElementById('sName').innerText = "سورة " + s.n;
            
            localStorage.setItem('lastPage', p); // حفظ التقدم
            
            wrapper.style.transform = 'translateX(0)';
            wrapper.style.opacity = '1';
        }, 300);
    }

    function goNext() { if(p < 604) { p++; draw('next'); } }
    function goPrev() { if(p > 1) { p--; draw('prev'); } }
    function jumpTo(val) { if(val) { p = parseInt(val); draw('next'); } }

    // تحسين تجربة اللمس الذكي
    const tArea = document.getElementById('touchArea');
    tArea.addEventListener('touchstart', e => { xStart = e.touches[0].clientX; });
    tArea.addEventListener('touchend', e => {
        if (!xStart) return;
        let xDiff = xStart - e.changedTouches[0].clientX;
        if (Math.abs(xDiff) > 50) {
            if (xDiff < 0) goNext(); else goPrev(); // مهارة: تقليب متوافق مع حركة اليد العربية
        }
        xStart = null;
    });

    function filterSurahs(v) {
        const l = document.getElementById('sList');
        l.innerHTML = '<option value="">الفهرس..</option>';
        data.filter(s => s.n.includes(v)).forEach(s => l.add(new Option(s.n, s.p)));
    }

    window.onload = () => { filterSurahs(''); draw(); };
</script>
</body>
</html>
