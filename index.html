<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>مصحف الجوال - العرض المنضبط</title>
    <style>
        :root { --gold: #c4a484; --bg: #0b0b0b; }
        body { background: var(--bg); margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; color: white; font-family: sans-serif; }

        /* الهيدر: شريط نحيف جداً */
        .nav-header { background: #1a1a1a; padding: 5px 10px; border-bottom: 1px solid var(--gold); display: flex; justify-content: space-between; align-items: center; height: 40px; flex-shrink: 0; }
        .info { font-size: 12px; color: var(--gold); }
        
        .controls { display: flex; gap: 5px; }
        .s-input { width: 60px; background: #222; border: 1px solid #444; color: white; border-radius: 4px; padding: 3px; font-size: 10px; }
        .btn { background: var(--gold); border: none; padding: 4px 10px; border-radius: 4px; cursor: pointer; font-size: 11px; font-weight: bold; color: black; }

        /* منطقة القراءة: السر هنا في منع التمدد */
        .viewer { 
            flex: 1; 
            display: flex; 
            justify-content: center; 
            align-items: center; /* يضع الصفحة في المنتصف تماماً */
            background: #000; 
            overflow: hidden; 
            padding: 10px;
        }

        #qPage { 
            max-width: 100%; 
            max-height: 100%; 
            width: auto;  /* يمنع التمدد العرضي الإجباري */
            height: auto; /* يحافظ على التناسب */
            object-fit: contain; /* يضمن عدم خروج الصورة عن الإطار */
            box-shadow: 0 0 15px rgba(255,255,255,0.05);
            display: block;
        }
    </style>
</head>
<body>

<div class="nav-header">
    <div class="info">
        <b id="sName">سورة الفاتحة</b> | صـ <span id="pNum">1</span>
    </div>
    <div class="controls">
        <input type="text" class="s-input" id="srch" placeholder="بحث.." oninput="filterSurahs(this.value)">
        <select id="sList" class="s-input" style="width: 70px;" onchange="jumpTo(this.value)"></select>
        <button class="btn" onclick="goPrev()">السابق</button>
        <button class="btn" onclick="goNext()">التالي</button>
    </div>
</div>

<div class="viewer" id="touchArea">
    <img id="qPage" src="001.jpg" onerror="this.src='https://raw.githubusercontent.com/search5/quran-images/master/001.jpg'">
</div>

<script>
    let p = 1;
    let xDown = null;

    const data = [
        {n: "الفاتحة", p: 1}, {n: "البقرة", p: 2}, {n: "آل عمران", p: 50}, {n: "النساء", p: 77}, {n: "المائدة", p: 106},
        {n: "الأنعام", p: 128}, {n: "الأعراف", p: 151}, {n: "الأنفال", p: 177}, {n: "التوبة", p: 187}
        // ... يمكنك إضافة باقي السور هنا
    ];

    function draw() {
        const img = document.getElementById('qPage');
        const num = p.toString().padStart(3, '0');
        img.src = `${num}.jpg`;
        document.getElementById('pNum').innerText = p;
        const s = data.filter(x => x.p <= p).slice(-1)[0];
        if(s) document.getElementById('sName').innerText = "سورة " + s.n;
    }

    function goNext() { if(p < 604) { p++; draw(); } }
    function goPrev() { if(p > 1) { p--; draw(); } }
    function jumpTo(val) { if(val) { p = parseInt(val); draw(); } }

    // دعم السحب للتقليب (Swipe)
    const tArea = document.getElementById('touchArea');
    tArea.addEventListener('touchstart', e => { xDown = e.touches[0].clientX; });
    tArea.addEventListener('touchend', e => {
        if (!xDown) return;
        let xDiff = xDown - e.changedTouches[0].clientX;
        if (Math.abs(xDiff) > 50) {
            if (xDiff > 0) goNext(); else goPrev();
        }
        xDown = null;
    });

    function filterSurahs(v) {
        const l = document.getElementById('sList');
        l.innerHTML = '<option value="">الفهرس..</option>';
        data.filter(s => s.n.includes(v)).forEach(s => l.add(new Option(s.n, s.p)));
    }

    window.onload = () => { filterSurahs(''); };
</script>
</body>
</html>
